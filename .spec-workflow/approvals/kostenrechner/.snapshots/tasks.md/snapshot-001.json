{
  "id": "snapshot_1763643791933_qx0oigjh5",
  "approvalId": "approval_1763643791930_diwarxiqy",
  "approvalTitle": "Tasks Document - Kostenrechner (43 Tasks)",
  "version": 1,
  "timestamp": "2025-11-20T13:03:11.933Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Tasks Document: Kostenrechner\n\n## Phase 1: Foundation & Type System\n\n- [ ] 1.1. Create TypeScript types and interfaces\n  - Files: `lib/calculator/types.ts`\n  - Define all TypeScript interfaces for Calculator State, Comparison Result, Provider Estimate\n  - Export all types for use in components\n  - Purpose: Establish type safety foundation\n  - _Leverage: Existing type patterns from `lib/content/frontmatter.ts`_\n  - _Requirements: All requirements (foundational)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: TypeScript Developer specializing in type systems | Task: Create comprehensive TypeScript interfaces in lib/calculator/types.ts following the design document's \"Data Models\" section, including CalculatorState, ComparisonResult, ProviderEstimate, PriceRange, DurationRange, BreakdownItem, and LeadData interfaces | Restrictions: Use strict TypeScript types, follow PascalCase naming for interfaces, use type unions for enums | Success: All interfaces compile without errors, types are exported and importable, follows project TypeScript strict mode standards | Instructions: After implementing, mark this task as in-progress in tasks.md by changing [ ] to [-], then after completion log implementation with log-implementation tool including artifacts (all interfaces created), then mark as complete [x]_\n\n- [ ] 1.2. Create pricing configuration\n  - Files: `lib/calculator/pricing-config.ts`\n  - Define all base prices, multipliers, feature costs, quality costs\n  - Export configuration objects and helper functions\n  - Purpose: Centralize all pricing data\n  - _Leverage: Pattern from `lib/content/glossary.ts` for data structures_\n  - _Requirements: Requirements 2-6 (all pricing rules)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Backend Developer with pricing system expertise | Task: Create pricing-config.ts with all base prices, multipliers, and cost definitions from design document's \"Pricing-Logik\" section in feature plan, including getBasePrice(), getDesignMultiplier(), getFeatureCost(), getQualityCost() helper functions | Restrictions: Use SCREAMING_SNAKE_CASE for constant exports, return PriceRange objects (min/max/avg), ensure all multipliers are numbers | Success: All pricing data is defined, helper functions return correct types, configuration is importable and type-safe | Instructions: Set task to in-progress [-], implement, log with log-implementation tool (artifacts: pricing configuration objects and helper functions), mark complete [x]_\n\n- [ ] 1.3. Create Zod validation schemas\n  - Files: `lib/calculator/validation-schemas.ts`\n  - Create schemas for CalculatorState, LeadCapture, API Request\n  - Export schemas and inferred types\n  - Purpose: Runtime validation for forms and API\n  - _Leverage: Existing patterns from `lib/validations.ts` and `lib/content/frontmatter.ts`_\n  - _Requirements: Requirements 9, 11 (validation requirements)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: TypeScript Developer with Zod validation expertise | Task: Create validation-schemas.ts with Zod schemas for calculatorStateSchema, leadCaptureSchema, and calculatorAPISchema as defined in design document's \"Zod Validation Schemas\" section, following patterns from lib/validations.ts | Restrictions: Use German error messages, make optional fields .optional(), use .refine() for custom validation | Success: All schemas validate correctly, type inference works (z.infer), error messages are clear in German | Instructions: Mark in-progress [-], implement schemas, log implementation with artifacts (Zod schemas created), mark complete [x]_\n\n- [ ] 1.4. Create calculator engine\n  - Files: `lib/calculator/calculator-engine.ts`\n  - Implement calculateComparison(), calculateHeadonPrice(), calculateFreelancerPrice(), calculateAgencyPrice()\n  - Add calculateDuration(), calculateBreakdown() functions\n  - Purpose: Core calculation logic\n  - _Leverage: Pure function patterns, TypeScript types from 1.1_\n  - _Requirements: Requirements 2-8 (all calculation rules)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Backend Developer with algorithm design expertise | Task: Implement calculator-engine.ts with all calculation functions as specified in design document's \"Berechnungs-Formel\" section, using pricing-config.ts and types.ts, implement calculateComparison() as main export that returns ComparisonResult | Restrictions: All functions must be pure (no side effects), handle edge cases gracefully, use pricing-config constants | Success: All calculation functions return correct types, math is accurate per spec, edge cases handled with fallbacks | Instructions: Set to in-progress [-], implement calculation logic, log with log-implementation tool (artifacts: calculation functions), mark complete [x]_\n\n- [ ] 1.5. Create utility helper functions\n  - Files: `lib/calculator/utils.ts`\n  - Implement formatCurrency(), formatDuration(), calculateTotal() helpers\n  - Export utility functions\n  - Purpose: Reusable formatting helpers\n  - _Leverage: Pattern from `@/lib/utils.ts`_\n  - _Requirements: All (formatting needs)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Frontend Developer with i18n/formatting expertise | Task: Create utils.ts with formatCurrency(number) returning German-formatted Euro string (12500 â†’ \"12.500â‚¬\"), formatDuration(DurationRange) returning German week range (\"6-8 Wochen\"), and calculateTotal(BreakdownItem[]) summing values | Restrictions: Use German number formatting (. as thousands separator), handle null/undefined gracefully, return empty strings for invalid inputs | Success: All formatters return correct German strings, functions are type-safe, edge cases handled | Instructions: Mark in-progress [-], implement formatters, log implementation with artifacts (utility functions), mark complete [x]_\n\n## Phase 2: Shared UI Components\n\n- [ ] 2.1. Install required shadcn/ui components\n  - Files: New shadcn components via CLI\n  - Run: `pnpm dlx shadcn@latest add checkbox radio-group slider progress switch tooltip`\n  - Purpose: Add missing UI primitives\n  - _Leverage: Existing `components.json` configuration_\n  - _Requirements: Design requirements for UI components_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Frontend Developer familiar with shadcn/ui | Task: Install shadcn/ui components using pnpm dlx shadcn@latest add for: checkbox, radio-group, slider, progress, switch, tooltip - run these commands in sequence and verify each installs to components/ui/ | Restrictions: Do not modify components after installation, verify components.json is unchanged, ensure Tailwind config includes components | Success: All 6 components installed in components/ui/, imports work correctly, components render without errors | Instructions: Mark in-progress [-], run install commands, log with log-implementation tool (artifacts: UI components added, list all installed), mark complete [x]_\n\n- [ ] 2.2. Create ProjectTypeCard component\n  - Files: `components/calculator/shared/ProjectTypeCard.tsx`\n  - Implement icon card with selection state, hover effects, price display\n  - Export component with TypeScript props interface\n  - Purpose: Reusable project type selector\n  - _Leverage: Framer Motion patterns from `app/contact/MultiStepForm.tsx`, Lucide icons_\n  - _Requirements: Requirement 2 (Step 1 - Projekttyp)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with Framer Motion expertise | Task: Create ProjectTypeCard.tsx component per design document's \"14. ProjectTypeCard.tsx\" section, implement with ProjectTypeCardProps interface, use motion.div with whileHover/whileTap, show Lucide icon, label, description, optional basePrice, selected state with CheckCircle2 icon | Restrictions: Must be client component ('use client'), use cn() from lib/utils, follow design's className patterns, handle onClick prop | Success: Component renders correctly, animations smooth, selected state visible, props type-safe | Instructions: Mark in-progress [-], create component, log with log-implementation tool (artifacts: React component created with props interface), mark complete [x]_\n\n- [ ] 2.3. Create FeatureCheckbox component\n  - Files: `components/calculator/shared/FeatureCheckbox.tsx`\n  - Implement checkbox with price badge, icon, description\n  - Handle checked state and onChange\n  - Purpose: Feature selection with pricing\n  - _Leverage: Checkbox from shadcn/ui, Badge component_\n  - _Requirements: Requirement 4 (Step 3 - FunktionalitÃ¤ten)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with form component expertise | Task: Create FeatureCheckbox.tsx per design document's \"15. FeatureCheckbox.tsx\" section, implement FeatureCheckboxProps with label, description, checked, onChange, price, icon props, use shadcn Checkbox and Badge components, show price as badge on right | Restrictions: Make entire div clickable, use cn() for conditional styling, handle both number and PriceRange for price prop | Success: Component toggles on click, badge shows formatted price, icon displays correctly, type-safe props | Instructions: Set in-progress [-], implement component, log with log-implementation (artifacts: component with props interface), mark complete [x]_\n\n- [ ] 2.4. Create RangeSlider component\n  - Files: `components/calculator/shared/RangeSlider.tsx`\n  - Implement custom slider with labels and current value display\n  - Use shadcn Slider component\n  - Purpose: Page count selection with visual feedback\n  - _Leverage: Slider from shadcn/ui_\n  - _Requirements: Requirement 3 (Step 2 - Design & Umfang)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with custom form controls expertise | Task: Create RangeSlider.tsx per design document's \"16. RangeSlider.tsx\" section, implement RangeSliderProps with value, onChange, min, max, step, optional labels and formatLabel, use shadcn Slider, display labels above slider, show formatted current value prominently below | Restrictions: Value must be controlled prop, use onValueChange from Slider correctly, highlight active label with text-primary-600 | Success: Slider updates on drag, labels display correctly, current value formatted and visible, type-safe | Instructions: Mark in-progress [-], create component, log implementation (artifacts: slider component), mark complete [x]_\n\n- [ ] 2.5. Create PriceCounter component\n  - Files: `components/calculator/shared/PriceCounter.tsx`\n  - Implement animated number counter for price updates\n  - Show price range below main price\n  - Purpose: Animated live price display\n  - _Leverage: Framer Motion or useEffect with setInterval_\n  - _Requirements: Requirement 7 (Live Price Preview)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with animation expertise | Task: Create PriceCounter.tsx per design document's \"17. PriceCounter.tsx\" section, implement animated number counting using useEffect + useState + setInterval (animate from previous to new value over 1 second), format with formatCurrency(), show min-max range below if provided | Restrictions: Clean up interval on unmount, debounce rapid changes, use text-4xl font-bold text-primary-600 for main price | Success: Numbers animate smoothly when value changes, formatting correct, no memory leaks, range displays when provided | Instructions: Set in-progress [-], implement animation logic, log with log-implementation (artifacts: animated component), mark complete [x]_\n\n- [ ] 2.6. Create shared components index\n  - Files: `components/calculator/shared/index.ts`\n  - Export all shared components as barrel export\n  - Purpose: Clean imports for step components\n  - _Leverage: Barrel export pattern_\n  - _Requirements: All (code organization)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: TypeScript Developer | Task: Create index.ts barrel export in components/calculator/shared/ that exports ProjectTypeCard, FeatureCheckbox, RangeSlider, PriceCounter using named exports | Restrictions: Use export { ComponentName } from './ComponentName' syntax, maintain alphabetical order | Success: All shared components importable from single path, no circular dependencies | Instructions: Mark in-progress [-], create index file, log implementation (artifacts: barrel export file), mark complete [x]_\n\n## Phase 3: Core Container Components\n\n- [ ] 3.1. Create CalculatorProgress component\n  - Files: `components/calculator/CalculatorProgress.tsx`\n  - Implement progress bar with step indicators (1/6, 2/6, ...)\n  - Add step labels and clickable navigation\n  - Purpose: Visual progress and navigation\n  - _Leverage: Progress bar pattern from `app/contact/MultiStepForm.tsx`, Framer Motion_\n  - _Requirements: Requirement 1 (Multi-Step Calculator Flow)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with multi-step form expertise | Task: Create CalculatorProgress.tsx per design document's \"2. CalculatorProgress.tsx\" section, implement CalculatorProgressProps with currentStep, totalSteps, onStepClick, allowBackNavigation, use motion.div for step circles, CheckCircle2 icon for completed steps, connector lines with animated fill | Restrictions: Must be client component, use AnimatePresence for step label transitions, only allow back navigation if allowBackNavigation=true | Success: Progress displays correctly, animations smooth, click navigation works, step labels update | Instructions: Set in-progress [-], create component, log with log-implementation (artifacts: progress component with animations), mark complete [x]_\n\n- [ ] 3.2. Create PricePreview component\n  - Files: `components/calculator/PricePreview.tsx`\n  - Implement sticky sidebar with live price, duration, breakdown\n  - Use PriceCounter for animated price\n  - Purpose: Real-time cost preview\n  - _Leverage: PriceCounter component (2.5), Calculator Engine (1.4)_\n  - _Requirements: Requirement 7 (Live Price Preview Sidebar)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with layout expertise | Task: Create PricePreview.tsx per design document's \"3. PricePreview.tsx\" section, implement PricePreviewProps with state and className, use useMemo to call calculateHeadonEstimate(state) and calculateBreakdown(state), display PriceCounter, duration with Clock icon, breakdown list with labels/values | Restrictions: Must use sticky top-24 positioning, use Card from shadcn/ui, memoize calculations to prevent unnecessary recalculations | Success: Preview updates when state changes, sticky positioning works, breakdown displays correctly, performant | Instructions: Mark in-progress [-], implement with useMemo, log implementation (artifacts: preview component with memoization), mark complete [x]_\n\n- [ ] 3.3. Create CostCalculator main container\n  - Files: `components/calculator/CostCalculator.tsx`\n  - Implement main state container with useState for CalculatorState\n  - Add step navigation (handleNext/handlePrev)\n  - Render CalculatorProgress, current step component, PricePreview\n  - Purpose: Central state and orchestration\n  - _Leverage: State management pattern from `app/contact/MultiStepForm.tsx`_\n  - _Requirements: Requirements 1-8 (all calculator flow)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Senior React Developer with state management expertise | Task: Create CostCalculator.tsx per design document's \"1. CostCalculator.tsx\" section, implement CalculatorState with useState, create defaultCalculatorState, handleNext/handlePrev functions, calculate comparison on step 6 with useEffect, use AnimatePresence for step transitions | Restrictions: Must be client component, use useMemo for currentStepComponent, ensure state doesn't reset on re-renders, handle currentStep between 1-6 | Success: State management robust, step navigation works, preview updates reactively, step 6 shows comparison | Instructions: Set in-progress [-], implement state container, log with log-implementation (artifacts: main container component with state management), mark complete [x]_\n\n## Phase 4: Step Components\n\n- [ ] 4.1. Create StepProjectType component\n  - Files: `components/calculator/steps/StepProjectType.tsx`\n  - Implement project type selection with ProjectTypeCard\n  - Map through 6-7 project types with icons\n  - Purpose: Step 1 - Project type selection\n  - _Leverage: ProjectTypeCard (2.2)_\n  - _Requirements: Requirement 2 (Step 1 - Projekttyp)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer | Task: Create StepProjectType.tsx per design document's \"4. StepProjectType.tsx\" section, implement StepProjectTypeProps with value and onChange, create projectTypes array with 6 options (website-simple, website-complex, web-app, mobile-app, ecommerce, custom) each with icon, label, description, basePrice, map through with ProjectTypeCard in grid gap-4 md:grid-cols-2 | Restrictions: Use Globe, Zap, Smartphone, ShoppingCart, Target icons from Lucide, stagger animations with delay: index * 0.1 | Success: All project types render, selection works, animations stagger correctly, base prices display | Instructions: Mark in-progress [-], implement step, log with log-implementation (artifacts: step component with project type data), mark complete [x]_\n\n- [ ] 4.2. Create StepDesignScope component\n  - Files: `components/calculator/steps/StepDesignScope.tsx`\n  - Implement design level (RadioGroup), page range (RangeSlider), responsiveness (Select), UX complexity (RadioGroup)\n  - Handle state updates for all 4 fields\n  - Purpose: Step 2 - Design configuration\n  - _Leverage: RangeSlider (2.4), RadioGroup, Select from shadcn/ui_\n  - _Requirements: Requirement 3 (Step 2 - Design & Umfang)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with form expertise | Task: Create StepDesignScope.tsx per design document's \"5. StepDesignScope.tsx\" section, implement StepDesignScopeProps with designLevel, pageRange, responsiveness, uxComplexity and onChange, create 4 sections: design level radio cards (template 1.0x, custom 1.5x, premium 2.0x), RangeSlider for pages (1-5, 6-15, 16-30, 30+), Select for responsiveness, RadioGroup for UX | Restrictions: Pass partial state updates to onChange, show multipliers in labels (e.g. \"Premium (2.0x)\"), use clear German labels | Success: All 4 fields render and update state, RangeSlider shows page range, multipliers clear, responsive layout | Instructions: Set in-progress [-], implement multi-field step, log implementation (artifacts: complex step component), mark complete [x]_\n\n- [ ] 4.3. Create StepFeatures component\n  - Files: `components/calculator/steps/StepFeatures.tsx`\n  - Implement 10+ feature checkboxes with conditional sub-options\n  - Use AnimatePresence for expanding sub-options\n  - Purpose: Step 3 - Feature selection\n  - _Leverage: FeatureCheckbox (2.3), RadioGroup, AnimatePresence_\n  - _Requirements: Requirement 4 (Step 3 - FunktionalitÃ¤ten)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with complex form state expertise | Task: Create StepFeatures.tsx per design document's \"6. StepFeatures.tsx\" section, implement StepFeaturesProps with features object and onChange, create FeatureCheckbox for each feature (cms, auth, database, payment, api, thirdPartyIntegrations, fileUploads, i18n, adminDashboard, realtime), add AnimatePresence conditional sub-options for cms (cmsType), auth (2FA, Social), database (complexity), payment (provider), api (type), i18n (languages count) | Restrictions: Use ml-8 for indented sub-options, animate with initial/animate/exit height and opacity, handle nested state updates correctly | Success: All features toggle, sub-options appear/disappear smoothly, state updates correctly, price badges show | Instructions: Mark in-progress [-], implement with conditional rendering, log with log-implementation (artifacts: complex feature component with conditional logic), mark complete [x]_\n\n- [ ] 4.4. Create StepQuality component\n  - Files: `components/calculator/steps/StepQuality.tsx`\n  - Implement quality options with Accordion (6 categories)\n  - SEO, Performance, Security, DSGVO, Testing, Accessibility\n  - Purpose: Step 4 - Quality requirements\n  - _Leverage: Accordion, RadioGroup from shadcn/ui_\n  - _Requirements: Requirement 5 (Step 4 - QualitÃ¤t & Performance)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer | Task: Create StepQuality.tsx per design document's \"7. StepQuality.tsx\" section, implement StepQualityProps with quality object and onChange, create Accordion with 6 AccordionItems (seo, performance, security, dsgvo, testing, accessibility), each with RadioGroup for levels (none/basic/advanced/enterprise or similar), show prices in labels, use icons (Search, Zap, Shield, Lock, TestTube, Eye) | Restrictions: Use type=\"multiple\" for Accordion to allow multiple open, include descriptions in small text for each level, handle checkbox for DSGVO separately | Success: All 6 accordions work, radio selections update state, prices visible, descriptions helpful | Instructions: Set in-progress [-], implement accordion structure, log with log-implementation (artifacts: quality step with accordion UI), mark complete [x]_\n\n- [ ] 4.5. Create StepTimeline component\n  - Files: `components/calculator/steps/StepTimeline.tsx`\n  - Implement timeline options: project start, maintenance, support, hosting, training\n  - Mix of RadioGroup, Select, Switch, Checkbox\n  - Purpose: Step 5 - Timeline configuration\n  - _Leverage: RadioGroup, Select, Switch from shadcn/ui_\n  - _Requirements: Requirement 6 (Step 5 - Timeline & Support)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer | Task: Create StepTimeline.tsx per design document's \"8. StepTimeline.tsx\" section, implement StepTimelineProps with timeline object and onChange, create 5 sections: project start radio cards (flexible, normal, urgent with 1.3x), maintenance radio cards (none, basic +150â‚¬/mo, premium +350â‚¬/mo), support Select (none, 3/6/12 months with one-time costs), hosting Switch (+50â‚¬/mo), training Checkbox (+800â‚¬) | Restrictions: Show monthly costs separately from one-time, use icons (Zap, Calendar, Clock, Target) for timeline options, indicate urgent with red/orange color | Success: All 5 fields update state, monthly vs one-time costs clear, urgent multiplier indicated visually | Instructions: Mark in-progress [-], create timeline step, log implementation (artifacts: timeline component with mixed input types), mark complete [x]_\n\n- [ ] 4.6. Create steps index barrel export\n  - Files: `components/calculator/steps/index.ts`\n  - Export all 5 step components\n  - Purpose: Clean imports\n  - _Leverage: Barrel export pattern_\n  - _Requirements: All (code organization)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: TypeScript Developer | Task: Create index.ts in components/calculator/steps/ that exports StepProjectType, StepDesignScope, StepFeatures, StepQuality, StepTimeline using named exports | Restrictions: Alphabetical order, named exports only | Success: All steps importable from single path | Instructions: Set in-progress [-], create barrel export, log with log-implementation (artifacts: barrel export), mark complete [x]_\n\n## Phase 5: Results Components\n\n- [ ] 5.1. Create ComparisonCard component\n  - Files: `components/calculator/results/ComparisonCard.tsx`\n  - Implement provider card with price, duration, quality stars, pros/cons\n  - Handle highlight prop for HEADON card\n  - Purpose: Single provider comparison display\n  - _Leverage: Card, Separator from shadcn/ui, Lucide icons_\n  - _Requirements: Requirement 8 (Step 6 - 3-Way Comparison)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer | Task: Create ComparisonCard.tsx per design document's \"10. ComparisonCard.tsx\" section, implement ComparisonCardProps with provider (ProviderEstimate) and highlight boolean, display price with formatCurrency (large text-3xl), duration with Clock icon, quality as 5 Star icons (filled based on quality number), pros with Check icon (green), cons with AlertCircle icon (orange), absolute positioned \"BESTE WAHL\" badge if highlighted | Restrictions: Use border-primary-600 border-2 for highlighted card, capitalize provider name, map through pros/cons arrays | Success: Card displays all info correctly, highlight styling prominent, stars render based on quality, pros/cons visible | Instructions: Mark in-progress [-], implement card, log with log-implementation (artifacts: comparison card component), mark complete [x]_\n\n- [ ] 5.2. Create ComparisonGrid component\n  - Files: `components/calculator/results/ComparisonGrid.tsx`\n  - Implement responsive grid (3 columns desktop) / Tabs (mobile)\n  - Render 3 ComparisonCards\n  - Purpose: Comparison layout\n  - _Leverage: ComparisonCard (5.1), Tabs from shadcn/ui_\n  - _Requirements: Requirement 8 (Step 6)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with responsive design expertise | Task: Create ComparisonGrid.tsx per design document's \"9. ComparisonGrid.tsx\" section, implement ComparisonGridProps with comparison and isMobile props, render grid gap-6 md:grid-cols-3 on desktop with 3 ComparisonCards, render Tabs with TabsList (3 triggers) and TabsContent on mobile, pass highlight=true to HEADON card | Restrictions: Detect mobile with window.innerWidth or CSS breakpoint, ensure tabs swipeable on touch devices | Success: Desktop shows 3-column grid, mobile shows tabs, HEADON card highlighted, responsive switch works | Instructions: Set in-progress [-], implement responsive layout, log with log-implementation (artifacts: grid component with responsive logic), mark complete [x]_\n\n- [ ] 5.3. Create SavingsHighlight component\n  - Files: `components/calculator/results/SavingsHighlight.tsx`\n  - Implement savings badge with animated appearance\n  - Show price and time savings vs agency\n  - Purpose: Highlight value proposition\n  - _Leverage: Framer Motion, formatCurrency_\n  - _Requirements: Requirement 8 (Savings Highlight)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer | Task: Create SavingsHighlight.tsx per design document's \"11. SavingsHighlight.tsx\" section, implement SavingsHighlightProps with savings object, calculate totalSavingsVsAgency and timeSavingsVsAgency from savings.vsAgency, display with motion.div initial scale 0.9 animate to 1, use gradient background from-green-50 to-emerald-50, show ðŸ’° emoji, large formatted price savings and week savings | Restrictions: Use text-4xl for emoji, text-2xl font-bold for heading, text-3xl font-extrabold text-green-700 for numbers | Success: Component animates on mount, savings calculated correctly, visually prominent, formatting correct | Instructions: Mark in-progress [-], create savings component, log implementation (artifacts: animated savings badge), mark complete [x]_\n\n- [ ] 5.4. Create PriceBreakdown component\n  - Files: `components/calculator/results/PriceBreakdown.tsx`\n  - Implement expandable accordion with categorized costs\n  - Calculate breakdown from state using calculator engine\n  - Purpose: Detailed cost transparency\n  - _Leverage: Accordion from shadcn/ui, Calculator Engine_\n  - _Requirements: Requirement 8 (Detailed Breakdown)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer | Task: Create PriceBreakdown.tsx per design document's \"12. PriceBreakdown.tsx\" section, implement PriceBreakdownProps with state and breakdown array, create Accordion with AccordionItem showing Calculator icon and \"Detaillierte AufschlÃ¼sselung\", map through breakdown categories showing category name, items (label/value), subtotal per category with Separator, final total at bottom | Restrictions: Use text-sm for items, font-semibold for category names and subtotal, text-lg font-bold text-primary-600 for total | Success: Accordion expands/collapses, all categories display, calculations sum correctly, formatting consistent | Instructions: Set in-progress [-], implement breakdown accordion, log with log-implementation (artifacts: breakdown component), mark complete [x]_\n\n- [ ] 5.5. Create LeadCaptureDialog component\n  - Files: `components/calculator/results/LeadCaptureDialog.tsx`\n  - Implement dialog with lead form (name, email, phone, message, preferredProvider)\n  - Handle form submission with validation\n  - Purpose: Lead capture from results\n  - _Leverage: Dialog, Input, Textarea, Select from shadcn/ui, leadCaptureSchema validation_\n  - _Requirements: Requirement 9 (Lead Capture Dialog)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: React Developer with form validation expertise | Task: Create LeadCaptureDialog.tsx per design document's \"13. LeadCaptureDialog.tsx\" section, implement LeadCaptureDialogProps with state, comparison, onSubmit props, create Dialog with trigger Button, form with Input (name, email, phone), Textarea (message), Select (preferredProvider with freelancer/agency/headon options defaulting to headon), validate with leadCaptureSchema before calling onSubmit, show success toast on submit, handle loading state | Restrictions: Must validate client-side with Zod, use toast from Sonner for feedback, disable submit while isSubmitting, clear form on success | Success: Dialog opens/closes, form validates, submission works, error handling robust, UX smooth | Instructions: Mark in-progress [-], implement dialog with form, log with log-implementation (artifacts: dialog component with form validation), mark complete [x]_\n\n- [ ] 5.6. Create results index barrel export\n  - Files: `components/calculator/results/index.ts`\n  - Export all results components\n  - Purpose: Clean imports\n  - _Leverage: Barrel export pattern_\n  - _Requirements: All (code organization)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: TypeScript Developer | Task: Create index.ts in components/calculator/results/ that exports ComparisonGrid, ComparisonCard, SavingsHighlight, PriceBreakdown, LeadCaptureDialog using named exports | Restrictions: Alphabetical order | Success: All results components importable from single path | Instructions: Set in-progress [-], create barrel export, log implementation (artifacts: barrel export), mark complete [x]_\n\n## Phase 6: Backend & Database\n\n- [ ] 6.1. Create Supabase database schema\n  - Files: Execute SQL in Supabase Dashboard or migration file\n  - Create `calculator_leads` table with all columns, indexes, RLS policies\n  - Optionally create `calculator_sessions` table\n  - Purpose: Data persistence for leads\n  - _Leverage: Existing Supabase setup, pattern from `leads` table_\n  - _Requirements: Requirement 9, 11 (Lead storage, tracking)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Database Administrator with PostgreSQL/Supabase expertise | Task: Execute SQL from design document's \"Supabase Database Schema\" section to create calculator_leads table with columns (id, created_at, name, email, phone, company, message, calculator_data JSONB, comparison_result JSONB, preferred_provider, lead_score, estimated_value, status, utm fields), create all indexes (email, created_at, status, lead_score, preferred_provider), enable RLS with service role policy, optionally create calculator_sessions table | Restrictions: Use uuid_generate_v4() for id, JSONB for complex objects, CHECK constraints for enums, test RLS policies work correctly | Success: Tables created successfully, indexes exist, RLS policies prevent unauthorized access, JSONB columns store data correctly | Instructions: Mark in-progress [-], execute SQL, log with log-implementation (artifacts: database tables with schema), mark complete [x]_\n\n- [ ] 6.2. Create calculator email template function\n  - Files: `lib/email-templates.ts` (add new function)\n  - Implement `createCalculatorResultEmail()` for user confirmation\n  - Implement `createCalculatorNotificationEmail()` for team notification\n  - Purpose: Email templates for leads\n  - _Leverage: Existing `createContactEmailTemplate()` pattern_\n  - _Requirements: Requirement 12 (Email-Benachrichtigungen)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Full-stack Developer with email template expertise | Task: Add two new functions to lib/email-templates.ts: createCalculatorResultEmail(leadData, comparison) returning HTML email for user with greeting, project summary, 3-way comparison table, savings highlight, CTA to book call (Calendly), cost breakdown; createCalculatorNotificationEmail(leadData, comparison) for team with lead score badge, lead info grid, calculator data, comparison result, reply-to set to user email - follow existing template patterns with inline CSS | Restrictions: Must return string with DOCTYPE html, use responsive tables, inline all CSS, use priority colors (green/orange/red) based on lead_score, German language throughout | Success: Both functions return valid HTML emails, tables render in email clients, responsive design works, German text correct | Instructions: Set in-progress [-], add template functions, log with log-implementation (artifacts: email template functions), mark complete [x]_\n\n- [ ] 6.3. Create API route for calculator\n  - Files: `app/api/calculator/route.ts`\n  - Implement POST handler with validation, Supabase save, email sending\n  - Calculate lead score based on budget, timeline, features\n  - Purpose: Backend endpoint for lead submission\n  - _Leverage: Pattern from `app/api/contact/route.ts`, Supabase client, Resend_\n  - _Requirements: Requirement 9, 12 (Lead capture, email notifications)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Backend Developer with API design expertise | Task: Create app/api/calculator/route.ts with POST handler following pattern from app/api/contact/route.ts, validate request body with calculatorAPISchema, calculate lead_score (budget high=+15, timeline urgent=+10, features count=+1 each, preferred HEADON=+10), save to calculator_leads with Supabase service role client, send 2 emails (user confirmation with createCalculatorResultEmail, team notification with createCalculatorNotificationEmail) via Resend, return success/error JSON response | Restrictions: Use try-catch for error handling, validate with Zod and return 400 on failure, don't block on email errors (log only), return 200 on success with { success: true, message } | Success: API validates input, saves to database correctly, calculates lead score accurately, sends both emails, returns proper status codes and errors | Instructions: Mark in-progress [-], implement API route, log with log-implementation (artifacts: API endpoint with validation and integrations), mark complete [x]_\n\n## Phase 7: Page & Routes\n\n- [ ] 7.1. Create calculator page metadata\n  - Files: `app/kostenrechner/metadata.ts`\n  - Define SEO metadata with title, description, keywords, OpenGraph, canonical\n  - Purpose: SEO optimization\n  - _Leverage: Metadata pattern from other pages_\n  - _Requirements: SEO requirements_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: SEO Specialist with Next.js metadata expertise | Task: Create app/kostenrechner/metadata.ts exporting Metadata object with title \"Kostenrechner: Website & App Entwicklung | HEADON.pro\", description (from design doc), keywords array (website kosten rechner, app entwicklung kosten, etc.), openGraph with title/description/images, alternates with canonical URL https://headon.pro/kostenrechner | Restrictions: Follow exact format from design document's \"Meta-Tags\" section, use German keywords, description 50-200 chars | Success: Metadata exports correctly, all fields defined, SEO-optimized for target keywords | Instructions: Set in-progress [-], create metadata file, log with log-implementation (artifacts: SEO metadata configuration), mark complete [x]_\n\n- [ ] 7.2. Create calculator page component\n  - Files: `app/kostenrechner/page.tsx`\n  - Import and render CostCalculator client component\n  - Add hero section with title and trust indicators\n  - Purpose: Entry page for calculator\n  - _Leverage: CostCalculator component (3.3)_\n  - _Requirements: Requirement 1 (Calculator entry)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Next.js Developer | Task: Create app/kostenrechner/page.tsx as Server Component, export metadata from './metadata', render hero section with h1 \"Was kostet Ihre Webseite? In 2 Minuten herausfinden\", trust indicators \"500+ Projekte â€¢ âŒ€4.9â˜… â€¢ 100% Transparenz\", then render CostCalculator component in max-w-7xl mx-auto container with padding | Restrictions: Page must be Server Component, only CostCalculator is 'use client', use semantic HTML (main, section, header tags) | Success: Page renders correctly, metadata applied, hero displays prominently, calculator loads, responsive layout | Instructions: Mark in-progress [-], create page component, log with log-implementation (artifacts: Next.js page component), mark complete [x]_\n\n- [ ] 7.3. Add Schema.org structured data\n  - Files: `app/kostenrechner/page.tsx` (add to page)\n  - Add JSON-LD script for WebApplication schema\n  - Purpose: Rich snippets in search results\n  - _Leverage: Schema builder pattern or inline JSON-LD_\n  - _Requirements: SEO requirements_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: SEO Developer with structured data expertise | Task: Add JSON-LD schema to app/kostenrechner/page.tsx using <script type=\"application/ld+json\"> with WebApplication schema from design document's \"Schema.org Markup\" section, including @context, @type, name, description, applicationCategory, offers (price 0), featureList array | Restrictions: Inline in page component, use dangerouslySetInnerHTML with JSON.stringify, validate with Google Rich Results Test | Success: Schema validates in Google tools, appears in page source, follows Schema.org WebApplication spec | Instructions: Set in-progress [-], add structured data, log implementation (artifacts: Schema.org markup), mark complete [x]_\n\n- [ ] 7.4. Integrate Umami analytics tracking\n  - Files: `app/kostenrechner/page.tsx` or CostCalculator component\n  - Add Umami event tracking for calculator interactions\n  - Track: step-completed, feature-selected, result-viewed, lead-captured, result-shared, abandoned\n  - Purpose: Conversion funnel analysis\n  - _Leverage: Existing Umami integration_\n  - _Requirements: Requirement 11 (Analytics & Event Tracking)_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Analytics Engineer with Umami expertise | Task: Add Umami tracking to CostCalculator component, use window.umami?.track() to send events: 'calculator-step-completed' with { step: number } on each step completion, 'calculator-feature-selected' with { feature: string } when features toggled, 'calculator-result-viewed' with { projectType, estimatedPrice, provider } on step 6, 'calculator-lead-captured' with { provider, leadScore, estimatedValue } on form submit, 'calculator-result-shared' on share click, 'calculator-abandoned' with { lastStep } on component unmount if not completed | Restrictions: Check window.umami exists before calling, don't block UI on tracking errors, use useEffect for unmount tracking | Success: All events fire correctly, appear in Umami dashboard, metadata captured, no errors if Umami unavailable | Instructions: Mark in-progress [-], add analytics, log with log-implementation (artifacts: Umami event tracking integration), mark complete [x]_\n\n## Phase 8: Testing & Polish\n\n- [ ] 8.1. Test calculator flow end-to-end manually\n  - Files: None (manual testing)\n  - Complete calculator from step 1-6, submit lead, verify email\n  - Test on desktop and mobile viewports\n  - Purpose: Functional verification\n  - _Leverage: Browser DevTools, Email inbox_\n  - _Requirements: All requirements_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Tester | Task: Manually test complete calculator flow: navigate to /kostenrechner, complete steps 1-6 selecting various options, verify live preview updates, check step 6 comparison displays correctly, submit lead form with test data, verify user email received, verify team email received, test on desktop (1920x1080) and mobile (375x667) viewports, check responsive layouts, test keyboard navigation | Restrictions: Document any bugs found, test with different input combinations, verify calculations match expected values from pricing config | Success: Calculator works end-to-end, no blocking bugs, emails deliver, responsive design works, accessibility basic compliance | Instructions: Mark in-progress [-], conduct manual testing, log with log-implementation (artifacts: testing report with findings), mark complete [x]_\n\n- [ ] 8.2. Fix any bugs found in testing\n  - Files: Various (depending on bugs)\n  - Address all bugs from manual testing\n  - Purpose: Bug resolution\n  - _Leverage: Error logs, debugging tools_\n  - _Requirements: All_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Senior Developer | Task: Review bugs documented in task 8.1, prioritize by severity, fix all blocking and high-priority bugs, test fixes, ensure no regressions introduced | Restrictions: Create separate commits per bug fix for tracking, add tests if bug was missed by testing gap, document fixes in code comments if complex | Success: All critical bugs resolved, fixes tested and verified, no new bugs introduced | Instructions: Set in-progress [-], fix bugs, log with log-implementation (artifacts: bug fixes with descriptions), mark complete [x]_\n\n- [ ] 8.3. Optimize performance\n  - Files: Various components\n  - Add React.memo where needed, optimize re-renders, lazy load step components\n  - Measure with Lighthouse\n  - Purpose: Performance targets (LCP < 1.5s)\n  - _Leverage: React.memo, React.lazy, useMemo, useCallback_\n  - _Requirements: Performance requirements_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Performance Engineer | Task: Optimize calculator performance: wrap shared components in React.memo, use React.lazy for step components with Suspense fallback, add useCallback for event handlers passed as props, verify useMemo for expensive calculations, run Lighthouse on /kostenrechner and optimize to achieve LCP < 1.5s, FID < 100ms, CLS < 0.1, Score 95+ | Restrictions: Don't over-optimize (avoid premature optimization), measure before/after with Lighthouse, ensure optimizations don't break functionality | Success: Lighthouse scores meet targets, page loads under 1.5s LCP, no performance regressions, optimizations documented | Instructions: Mark in-progress [-], implement optimizations, log with log-implementation (artifacts: performance optimizations with before/after metrics), mark complete [x]_\n\n- [ ] 8.4. Verify accessibility compliance\n  - Files: All components\n  - Test keyboard navigation, screen reader support, color contrast\n  - Aim for WCAG AA compliance\n  - Purpose: Accessibility requirements\n  - _Leverage: Keyboard, axe DevTools, WAVE_\n  - _Requirements: Accessibility requirements_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Accessibility Specialist | Task: Verify WCAG AA compliance for calculator: test complete keyboard navigation (Tab, Enter, Arrow keys, Escape), verify all interactive elements have focus indicators, test with screen reader (NVDA/JAWS/VoiceOver), check color contrast ratios with axe DevTools, ensure ARIA labels present where needed, verify form labels associated, run WAVE and fix flagged issues | Restrictions: Don't rely on color alone for information, ensure keyboard focus order is logical, all images have alt text | Success: Full keyboard navigation works, screen reader announces correctly, color contrast meets 4.5:1, ARIA implemented properly, WAVE/axe pass | Instructions: Set in-progress [-], conduct accessibility audit, log with log-implementation (artifacts: accessibility improvements and compliance report), mark complete [x]_\n\n- [ ] 8.5. Write documentation\n  - Files: `docs/kostenrechner-feature-plan.md` (update status), README additions\n  - Document calculator usage, pricing logic, customization guide\n  - Purpose: Maintainability\n  - _Leverage: Existing docs pattern_\n  - _Requirements: Documentation requirements_\n  - _Prompt: Implement the task for spec kostenrechner, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Technical Writer | Task: Update docs/kostenrechner-feature-plan.md status to ðŸŸ¢ Complete, add \"Implementation Notes\" section documenting: calculator structure and components, how to update pricing (edit pricing-config.ts), how to add new features (extend types + add to StepFeatures), calculator engine explanation, email template customization, how to modify lead scoring, analytics events reference, troubleshooting common issues | Restrictions: Use clear language, include code examples where helpful, link to relevant files, keep concise | Success: Documentation complete and accurate, maintainers can understand and modify calculator, troubleshooting guide useful | Instructions: Mark in-progress [-], write documentation, log with log-implementation (artifacts: documentation files updated), mark complete [x]_\n\n---\n\n## Summary\n\n**Total Tasks:** 43 atomic tasks\n**Estimated Duration:** 18-25 days (solo developer) or 10-15 days (2 developers parallel)\n\n**Phases:**\n1. Foundation (5 tasks): Types, pricing, validation, engine, utils\n2. Shared UI (6 tasks): shadcn install, 4 shared components, index\n3. Core (3 tasks): Progress, Preview, Main Container\n4. Steps (6 tasks): 5 step components, index\n5. Results (6 tasks): 5 result components, index\n6. Backend (3 tasks): Database, email templates, API\n7. Page (4 tasks): Metadata, page, schema, analytics\n8. Testing & Polish (5 tasks): Manual test, bugs, performance, a11y, docs\n\n**Dependencies Flow:**\n- Phase 1 â†’ All other phases (foundation)\n- Phase 2 â†’ Phases 3-5 (components)\n- Phases 3-5 can partially overlap\n- Phase 6 parallel to 3-5 (backend independent)\n- Phase 7 depends on 3-5 (page uses components)\n- Phase 8 after all (testing & polish)\n\n**Implementation Order:**\n1. Start with Phase 1 (1.1 â†’ 1.5 sequential)\n2. Install shadcn components (2.1)\n3. Build shared components (2.2 â†’ 2.5 parallel possible)\n4. Core container (3.1 â†’ 3.3 sequential)\n5. Step components (4.1 â†’ 4.5 can be parallel)\n6. Results components (5.1 â†’ 5.5 partially parallel)\n7. Backend (6.1 â†’ 6.3 sequential)\n8. Page integration (7.1 â†’ 7.4 sequential)\n9. Testing & polish (8.1 â†’ 8.5 sequential)\n\n**Each task includes:**\n- âœ… File paths\n- âœ… Clear description\n- âœ… _Leverage (what to reuse)\n- âœ… _Requirements (which requirements addressed)\n- âœ… _Prompt (complete implementation guide with role, task, restrictions, success criteria, and workflow instructions)\n",
  "fileStats": {
    "size": 49858,
    "lines": 396,
    "lastModified": "2025-11-20T13:03:05.217Z"
  },
  "comments": []
}